<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Klimawandel in Europa - Hammerfly&#39;s blog</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Hammerfly" /><meta name="description" content="Einleitung Die Beobachtungen der letzten Jahrzehnte haben gezeigt, dass sich das Klima verändert. Globale Erwärmung, saurer Regen und das Ozonloch sind unsere größten Umweltbedrohungen. Dies hat zum Abschmelzen der Gletscher, zu häufigen Extremwetterereignissen, zum Rückg" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.88.1 with theme even" />


<link rel="canonical" href="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Klimawandel in Europa" />
<meta property="og:description" content="Einleitung Die Beobachtungen der letzten Jahrzehnte haben gezeigt, dass sich das Klima verändert. Globale Erwärmung, saurer Regen und das Ozonloch sind unsere größten Umweltbedrohungen. Dies hat zum Abschmelzen der Gletscher, zu häufigen Extremwetterereignissen, zum Rückg" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-10-08T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-10-08T17:30:55+02:00" />

<meta itemprop="name" content="Klimawandel in Europa">
<meta itemprop="description" content="Einleitung Die Beobachtungen der letzten Jahrzehnte haben gezeigt, dass sich das Klima verändert. Globale Erwärmung, saurer Regen und das Ozonloch sind unsere größten Umweltbedrohungen. Dies hat zum Abschmelzen der Gletscher, zu häufigen Extremwetterereignissen, zum Rückg"><meta itemprop="datePublished" content="2021-10-08T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-10-08T17:30:55+02:00" />
<meta itemprop="wordCount" content="5898">
<meta itemprop="keywords" content="生态学," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Klimawandel in Europa"/>
<meta name="twitter:description" content="Einleitung Die Beobachtungen der letzten Jahrzehnte haben gezeigt, dass sich das Klima verändert. Globale Erwärmung, saurer Regen und das Ozonloch sind unsere größten Umweltbedrohungen. Dies hat zum Abschmelzen der Gletscher, zu häufigen Extremwetterereignissen, zum Rückg"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Hammerfly</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Hammerfly</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Klimawandel in Europa</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-10-08 </span>
        
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#einleitung">Einleitung</a></li>
    <li><a href="#daten-und-methoden">Daten und Methoden</a>
      <ul>
        <li><a href="#daten">Daten</a></li>
        <li><a href="#niederschlagsveränderungen-für-biomen">Niederschlagsveränderungen für Biomen</a></li>
        <li><a href="#interpolation-mit-hilfe-von-kriging">Interpolation mit Hilfe von Kriging</a></li>
      </ul>
    </li>
    <li><a href="#ergebnisse">Ergebnisse</a></li>
    <li><a href="#diskussion">Diskussion</a></li>
    <li><a href="#literatur">Literatur</a></li>
    <li><a href="#anhang">Anhang</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h1 id="einleitung">Einleitung</h1>
<!-- 最近几十年的观测显示,气候在变化。气候变暖，出现酸雨，臭氧层被破坏。这导致冰川消融，极端气候频发，粮食减产，海平面上升和物种灭绝。气候变化对陆地和海洋生态系统和健康都有负面影响。降雨量作为气候的重要要素同样也发生了改变。在1901年至2003年极端强降水增加（ipcc p28), 而欧洲的北欧多雨而地中海少雨。 -->
<p>Die Beobachtungen der letzten Jahrzehnte haben gezeigt, dass sich das Klima verändert. Globale Erwärmung, saurer Regen und das Ozonloch sind unsere größten Umweltbedrohungen. Dies hat zum Abschmelzen der Gletscher, zu häufigen Extremwetterereignissen, zum Rückgang der Nahrungsmittelproduktion, zum Anstieg des Meeresspiegels und zum Aussterben von Arten geführt. Der Klimawandel hat negative Auswirkungen auf terrestrische und marine Ökosysteme und die Gesundheit. Die Niederschläge, ein wichtiges Element des Klimas, haben sich ebenfalls verändert. Zwischen 1901 und 2003 kam es zu einer Zunahme der extremen Niederschläge, während es in Europa in Nordeuropa mehr und im Mittelmeerraum weniger regnete (<a href="#ref-climate2008">Bates et al., 2008</a>).</p>
<!-- 降雨量的变化可能与多种因素有关。降雨很大程度上取决于温度和天气条件。在干旱的地区，高温会使地表变干加速而使气温升高，而湿润地区高温会加速水的蒸发从而增加降雨。同时，厄尔尼诺和大西洋涛动也会影响降雨的强度和分布，使一些地区更干旱而另一些地区更湿润。大西洋涛动的NAO Index表示Differenz der Druckabweichung an der Station in Ponta Delgaza und Stykkisholmur. 当其为正时北欧的降水量会增加，而地中海沿岸降水量减少。当其为负时北欧的降水量减少，地中海区域降水量增加。 -->
<p>Veränderung in der Niederschlagsmenge können von verschiedenen Faktoren abhängen. Die Niederschlagsmenge hängt in hohem Maße von der Temperatur und den Wetterbedingungen ab. In trockenen Gebieten können hohe Temperaturen den Boden schneller austrocknen und die Temperaturen erhöhen, während hohe Temperaturen in feuchten Gebieten die Niederschläge erhöhen können, indem sie die Wasserverdunstung beschleunigen. Gleichzeitig können El Niño und die Nordatlantische Oszillation (NAO) auch die Intensität und Verteilung der Niederschläge beeinflussen und einige Gebiete trockener und andere feuchter machen (<a href="#ref-climate2008">Bates et al., 2008</a>). Der NAO-Index für die NAO gibt die Differenz der Druckabweichung an der Station in Ponta Delgada und Stykkishólmur an. Wenn er positiv ist, nehmen die Niederschläge in Nordeuropa zu und an der Mittelmeerküste ab. Wenn er negativ ist, nehmen die Niederschläge in Nordeuropa ab und die Niederschläge im Mittelmeerraum zu (<a href="#ref-dahlman2009">Dahlman, 2009</a>).</p>
<!-- die Veränderung im Niederschlagsregime in Europa in den letzten Jahrzehnten 可能与Biome相关。所以欧洲的每个Biome的平均Veränderung im Niederschlagsregime zwischen den beiden Perioden 1962 bis 1970 und 2010 bis 2018 被计算，整个欧洲的降雨量改变图被interpoliert，降雨量增加或者减少超过5%的风险区域被确定。 -->
<p>Die Veränderung des Niederschlagsregimes in Europa in den letzten Jahrzehnten könnte mit Biomen zusammenhängen. So wurde die durchschnittliche Veränderung im Niederschlagsregime für jedes Biome in Europa zwischen den beiden Perioden: 1962 bis 1970 und 2010 bis 2018 berechnet und die Veränderung der Niederschläge in ganz Europa interpoliert. Die Risikobereiche, in denen der Niederschlag um mehr als 5 % zu- oder abnimmt, wurden ermittelt.</p>
<h1 id="daten-und-methoden">Daten und Methoden</h1>
<h2 id="daten">Daten</h2>
<!-- 练习中使用的数据集 KlimaStatEuropa_Niedersschlaege 包含了两个Perioden: 1962 bis 1970 和 2010 bis 2018 的平均年降雨量（mm, Mittelwert, Standardabweichung）并附带经度和纬度坐标，坐标系是WSG 84。1962年到1970年欧洲各Klimastationen的平均年降雨量在145mm到2590mm不等。而2010年到2018年其平均年降水量分布在132到2792之间。其空间上的分布见图xxx. -->
<p>Im Zuge dieser Übung wurden Software r (Version 4.0.5) und R-Pakete gstat_2.0-7, rgdal_1.5-23, dplyr_1.0.6, tmap_3.3-2, raster_3.4-10, und sp_1.4-5 verwendet (Siehe <a href="#anhang">Anhang</a> für den vollständigen Code).Der in der Übung verwendete Datensatz <code>KlimaStatEuropa_Niedersschlaege</code> enthält die durchschnittliche jährliche Niederschlagsmenge (mm, Mittelwert, Standardabweichung) für zwei Zeiträume: 1962 bis 1970 und 2010 bis 2018 mit den Koordinaten der Längen- und Breitengrade im WSG 84. Die durchschnittliche jährliche Niederschlagsmenge in den europäischen Klimastationen von 1962 bis 1970 schwankt zwischen 145 mm und 2590 mm. Im Gegensatz dazu lag die durchschnittliche jährliche Niederschlagsverteilung von 2010 bis 2018 zwischen 132 mm und 2792 mm. Ihre räumliche Verteilung ist in Abbildung <a href="#fig:data">1</a>dargestellt.</p>
<!-- 使用的地类Biome_Europa Shape-file 包含了欧洲的地类数据，欧洲的Biomen被分为9类。主要有最北部的斯堪的纳维亚山为Tundra,北欧的Taiga/Forests，中欧大片的Temperate Broadleaf & Mixed Forests，南部地中海沿岸的Mediterranean Forests，Woodlands & Scrub, 东部黑海低地的Temperate Grassland, Savannas & Shrublands，以及阿尔卑斯山，Carpathian Mountains以及苏格兰高地的Temperate Conifer Forests. -->
<p>Die <code>Biome_Europa</code> Shape-Datei enthält Daten über die Biome Europas, die in neun Kategorien unterteilt sind. Die Hauptkategorien sind Tundra für die nördlichsten skandinavischen Gebirge, Taiga/Forests für Nordeuropa, Temperate Broadleaf &amp; Mixed Forests in Mitteleuropa, Mediterranean Forests, Woodlands &amp; Scrub für die südliche Mittelmeerküste, Temperate Grassland, Savannas &amp; Shrublands für das Schwarzmeertiefland und Temperate Conifer Forests in den Alpen, den Karpaten und den schottischen Highlands.</p>
<div class="figure">
<p><img src="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/index.en_files/figure-html/data-1.png" alt="In der übung verwendete Daten: Verteilung der Biome und Klimastationen in Europa. Die weissen Punkte sind die Standorte der Klimastationen." width="672" /></p>
<p class="caption">
Figure 1: In der übung verwendete Daten: Verteilung der Biome und Klimastationen in Europa. Die weissen Punkte sind die Standorte der Klimastationen.
</p>
</div>
<h2 id="niederschlagsveränderungen-für-biomen">Niederschlagsveränderungen für Biomen</h2>
<!-- 用两个Perioden的年降水量之差算出各个Klimastationen的降水量改变量，并除以Perioden 1(1962年到1970年)的降水量可以得到降水量的相对改变量。 -->
<p>Die Differenz des Jahresniederschlags zwischen den beiden Perioden wurde zur Berechnung der Niederschlagsänderung für jede Klimastation verwendet. Die absolute Veränderung wird durch die Niederschlagsmenge von Periode 1 (1962 bis 1970) geteilt, um die relative Veränderung der Niederschlagsmenge zu erhalten.</p>
<!-- 把数据集 KlimaStatEuropa_NiedersschlaegeErgebnisse 转换为sp-Objekt后在r中使用命令sp包中的aggregate计算出了欧洲的每个Biome的平均Veränderung im Niederschlagsregime。 -->
<p>Nach der Konvertierung des Datensatzes <code>KlimaStatEuropa_NiedersschlaegeErgebnisse</code> in <code>sp-Objekt</code> wurde die durchschnittliche Veränderung im Niederschlagsregime für jedes Biome in Europa in r mit dem Befehl <code>aggregate</code> im <code>sp-Paket</code> berechnet.</p>
<h2 id="interpolation-mit-hilfe-von-kriging">Interpolation mit Hilfe von Kriging</h2>
<!-- Interpolation使用的是Kriging法。Kriging法借助一个半变异函数可以预测不具有数据的地区的数值。 -->
<p>Bei der Interpolation wird die Kriging-Methode angewandt, bei der die Werte von Gebieten, für die keine Daten vorliegen, mit Hilfe eines Variogramm-Modells vorhergesagt werden. Das Variogramm-Modell beschreibt den Zusammenhang zwischen dem Abstand eines Punktpaares und seiner Varianz der Differenz. Ein lineares Trendmodell wird unter Verwendung des Längen- und Breitengrades der Klimastationen als unabhängige Variablen erstellt, um trendbereinigte Daten zu erhalten. Und dann mit Hilfe einer Variogramm-Analyse wurden die Daten untersucht. Die mittleren Variogrammwerte wurden mit der Funktion <code>variogram</code> in Package <code>gstat</code> berechnet und mit vier Modellen: lineares Modell, sphärisches Modell, exponentielles Modell und Gauß Modell angepasst. Die vier Modelle wurden verglichen und das Modell mit dem geringsten Fehler wurde als endgültiges Variogramm-Modell für Kriging verwendet.</p>
<p>Der Risikobereich wird nach der Indikator-Kriging-Methode berechnet. Das gleiche Trendmodell wie beim letzten Abschnitt wurde genommen, um den Bereichen zu berechnen, bei denen die relative Zu- bzw. Abnahme der Jahresniederschlag größer oder gleich 5% ist. Variogramm-Schätzer wurde auch von den linearen, sphärischen, exponentiellen und Gauß’schen Modelle angepasst. Das beste Modell wurde für Kriging übriggelassen.</p>
<h1 id="ergebnisse">Ergebnisse</h1>
<!-- Um die Veränderungen im Niederschlagsregime in Europa in den letzten Jahrzehnten zu ermitteln, wurden die absolute und relative Veränderung der mittleren Jahrensniederschaläge zwischen den beiden Perioden 1962 bis 1970 und 2010 bis 2018 für die einzelnen Klimastationen berechnet und kartografisch dargestellt. 在欧洲北部降雨量增加，尤其在西北部的几个Klimastationen降雨量增加超过300mm。而欧洲南部降雨量减少，超过10个Klimastationen都减少超过100mm.北部多个Klimastationen的relative Veränderung增长超过10%，而relative Veränderung减少最多的地方在西南部的一个Klimastation，超过了20%。总体来说，欧洲的降雨量在1962到2018年之间北部增加，南部减少。 -->
<p>Um die Veränderungen im Niederschlagsregime in Europa in den letzten Jahrzehnten zu ermitteln，wurden die absolute und relative Veränderung der mittleren Jahrensniederschaläge zwischen den beiden Perioden 1962 bis 1970 und 2010 bis 2018 für die einzelnen Klimastationen berechnet und kartografisch dargestellt. Im Norden Europas nahmen die Niederschläge zu, vor allem in mehreren Klimastationen im Nordwesten, wo die Niederschläge um mehr als 300 mm zunahmen und die relative Niederschlag 10% überstieg (Abbildung <a href="#fig:points">2</a>). Während im Süden Europas die Niederschläge abnahmen, und zwar in mehr als 10 Klimastationen um mehr als 100 mm. Der größte Rückgang der relativen Veränderung fand in einer der südwestlichen Klimastationen statt, mit einem Rückgang von mehr als 20%. Insgesamt haben die Niederschläge in Europa zwischen 1962 und 2018 im Norden zu- und im Süden abgenommen.</p>
<div class="figure">
<p><img src="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/index.en_files/figure-html/points-1.png" alt="Absolute (a) und relative (b) Veraenderung der mittleren Jahresniederschlaege an europaeischen Klimastationen zwischen den beiden Perioden 1962 bis 1970 und 2010 bis 2018." width="50%" /><img src="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/index.en_files/figure-html/points-2.png" alt="Absolute (a) und relative (b) Veraenderung der mittleren Jahresniederschlaege an europaeischen Klimastationen zwischen den beiden Perioden 1962 bis 1970 und 2010 bis 2018." width="50%" /></p>
<p class="caption">
Figure 2: Absolute (a) und relative (b) Veraenderung der mittleren Jahresniederschlaege an europaeischen Klimastationen zwischen den beiden Perioden 1962 bis 1970 und 2010 bis 2018.
</p>
</div>
<!-- 为了弄清欧洲 in den letzten Jahrzehnten 降水量变化和Biom的关系，各地类的年平均降水量的改变量wurden mit Hilfe von Balkendiagrammen und Karten dargestellt. 降水量增加最多的区域在北部的Tundra（什么Tundra?），超过100mm，平均降水量增加了10%以上。欧洲中部的森林（具体描述地区）也有0-50mm的增加，相对增长量在10%以下。而南部的Mediterranean Forests, Woodlands & Scrub und Grassland的降水量减少。Grassland的降雨量减少了3%，而最南部地中海沿岸的Mediterranean Forests减少了超过20mm, 相对降水量减少5%以上。 -->
<p>Um den Zusammenhang zwischen Niederschlagsveränderungen in den letzten Jahrzehnten und Biom in Europa zu verdeutlichen, wurde die Veränderung des durchschnittlichen Jahresniederschlags mit Hilfe von Balkendiagrammen und Karten für jedes Biom dargestellt. Das Gebiet mit der höchsten Niederschlagszunahme liegt in der Tundra in Nordeuropa, mit mehr als 100 mm und einer durchschnittlichen Zunahme der Niederschläge um mehr als 10 % (Abbildung <a href="#fig:biomrain">3</a>). Die Wälder Mitteleuropas weisen ebenfalls eine Zunahme von 0-50 mm auf, wobei die relative Zunahme weniger als 10 % beträgt. Im Gegensatz dazu verzeichneten Mediterranean Forests, Woodlands &amp; Scrub und Temperate Grasslands, Savannas &amp; Shrublands im Süden einen Rückgang der Niederschläge. Das Temperate Grasslands, Savannas &amp; Shrublands verzeichnete einen Rückgang der Niederschläge um 3 %, während die mediterranen Wälder einen Rückgang von über 20 mm verzeichneten, was einem relativen Rückgang von über 5 % entspricht.</p>
<div class="figure">
<p><img src="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/index.en_files/figure-html/biomrain-1.png" alt="Absolute (a,b) und relative (c,d) Veraenderung der mittleren Jahresniederschlaege für die europaeischen Biomen zwischen den beiden Perioden 1962 und 1970 und 2010 bis 2018." width="50%" /><img src="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/index.en_files/figure-html/biomrain-2.png" alt="Absolute (a,b) und relative (c,d) Veraenderung der mittleren Jahresniederschlaege für die europaeischen Biomen zwischen den beiden Perioden 1962 und 1970 und 2010 bis 2018." width="50%" /><img src="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/index.en_files/figure-html/biomrain-3.png" alt="Absolute (a,b) und relative (c,d) Veraenderung der mittleren Jahresniederschlaege für die europaeischen Biomen zwischen den beiden Perioden 1962 und 1970 und 2010 bis 2018." width="50%" /><img src="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/index.en_files/figure-html/biomrain-4.png" alt="Absolute (a,b) und relative (c,d) Veraenderung der mittleren Jahresniederschlaege für die europaeischen Biomen zwischen den beiden Perioden 1962 und 1970 und 2010 bis 2018." width="50%" /></p>
<p class="caption">
Figure 3: Absolute (a,b) und relative (c,d) Veraenderung der mittleren Jahresniederschlaege für die europaeischen Biomen zwischen den beiden Perioden 1962 und 1970 und 2010 bis 2018.
</p>
</div>
<!-- 为了建立Variogramm Modelle,确定降水量的变化与Klimastationen的距离的关系，以x, y als unabhängigen Variablen建立了线性模型并简化，去除相关性不显著的因变量，预测降水量的相对变化与坐标的关系，得出 -->
<p>Zur Erstellung des Variogramm-Modells, und den Zusammenhang zwischen der Veränderung des Niederschlags und der Entfernung von Klimastationen bestimmt, wurde ein lineares Modell mit <code>lon</code>, <code>lat</code> als unabhängigen Variablen aufgestellt und vereinfacht, indem die unabhängige Variable mit unbedeutender Korrelation entfernt. Die relative Veränderung des Niederschlags in Abhängigkeit von den Koordinaten vorhergesagt wurde. Die sich daraus ergebende Gleichung lautet:</p>
<!-- 其中deltaN为降水量的相对变化，lat为地理坐标的纬度，lon为地理坐标的经度。 -->
<p>wobei <code>deltaN</code> die relative Änderung des Niederschlags, <code>x</code> die Länge der geografischen Koordinaten und <code>y</code> die Breite der geografischen Koordinaten ist.</p>
<!-- 为了在Interpolation时选择最符合原始数据的VariogrammModelle，linear, sphärisch, exponential和gauß模型wurden 用图像dargestellt und 它们的误差大小被对比(图)。Gauß 模型是Fehler最小的模型，被用于Kriging. 模型的Nugget为6*10^-5,Sill为0.003，Range为536。 -->
<p>Um das Variogramm-Modell auszuwählen, das am besten zum Variogramm-Schätzer bei der Interpolation passen, wurden die Fehler der linearen, sphärischen, exponentiellen und Gauß’schen Modelle verglichen. Das Gauß-Modell ist das Modell mit dem kleinsten Fehler und wurde für Kriging verwendet. Das Modell hat ein Nugget von <code>\(6\cdot10^{-5}\)</code>, einen Sill von 0,003 und einen Practical range von 536.</p>
<!-- 借助Kriging法降水量的相对变化在整个欧洲的情况(预测值和误差)被Interpoliert.与原始数据相符合，降水量呈现北边增加南边减少的趋势。按照预测地图，增加最多的区域主要是在波罗的海东岸的Latvia,Estonia和lithuania等国家，大约增加20%。而降水量减少最严重的区域在南边的西班牙，大约减少了25%。同时，中欧的德国，以及黑海西北岸的Moldawien和Ukraine附近也是降水量减少比较严重的区域，降低了约10%。数据的误差整体非常小，在0.0016以下，且主要在地图边缘较大。 -->
<p>Die relativen Veränderungen des Niederschlags über ganz Europa (Schätzer und Fehler) wurden mit Hilfe der Kriging-Methode interpoliert. In Übereinstimmung mit den Originaldaten nimmt der Niederschlag im Norden tendenziell zu und im Süden ab (Abbildung <a href="#fig:universal">4</a>). Der Vorhersagekarte zufolge sind die größten Zuwächse vor allem in den Ländern Lettland, Estland und Litauen an der Ostküste der Ostsee zu verzeichnen, mit einem Anstieg von etwa 20 %. Der stärkste Niederschlagsrückgang ist in Spanien im Süden zu verzeichnen, mit einer Abnahme von etwa 25 %. Deutschland in Mitteleuropa und die Nordwestküste des Schwarzen Meeres um Moldawien und die Ukraine sind ebenfalls Gebiete, in denen die Niederschläge stärker zurückgegangen sind, nämlich um etwa 10 %. Die Fehler in den Daten sind insgesamt sehr gering (unter 0,0016) und sind vor allem an den Rändern der Karte größer.</p>
<div class="figure">
<p><img src="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/index.en_files/figure-html/universal-1.png" alt="Schaetzer (a) und Fehler (b) der Interpolation von europaeischen relativen Niederschlagsveraenderungen mit Hilfe von Kriging und dem Gau&lt;U+00DF&gt;schen Variogramm-Modell" width="50%" /><img src="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/index.en_files/figure-html/universal-2.png" alt="Schaetzer (a) und Fehler (b) der Interpolation von europaeischen relativen Niederschlagsveraenderungen mit Hilfe von Kriging und dem Gau&lt;U+00DF&gt;schen Variogramm-Modell" width="50%" /></p>
<p class="caption">
Figure 4: Schaetzer (a) und Fehler (b) der Interpolation von europaeischen relativen Niederschlagsveraenderungen mit Hilfe von Kriging und dem Gau&lt;U+00DF&gt;schen Variogramm-Modell
</p>
</div>
<p>Um zu erfahren, welche Regionen von der Veränderung der Niederschlagsregime besonders betroffen sind, wurden die Regionen, die das “Risiko” einer relativen Zu- bzw. Abnahme der Jahresniederschläge um &gt;= 5 % dargestellt. Die verschiedenen Variogramm-Modelle werden ebenfalls verglichen und sphärisch ist das beste Modell sowohl für Variogramm mit einer Niederschlagszunahme von mehr als 5% als auch für Variogramm mit einer Abnahme von mehr als 5%. Die Risikogebiete mit erhöhten Niederschlägen konzentrieren sich hauptsächlich auf Nordeuropa, vor allem auf Skandinavien im Norden, die baltischen Staaten und Westrussland, die Insel Irland, die Insel Großbritannien und den Südwesten des Schwarzen Meeres sowie auf die Ausläufer der Südostseite der Alpen (Abbildung <a href="#fig:indikator">5</a>). Das Risiko geringerer Niederschläge konzentriert sich auf den südlichen Teil der Iberischen Halbinsel, wo Spanien liegt, auf die Pyrenäen und das Aquitanische Becken im Norden, auf die italienische Halbinsel, auf Deutschland und auf das Tiefland am nordwestlichen Schwarzen Meer. Der Fehler bei der Zu- und Abnahme des Jahresniederschlags liegt im Wesentlichen unter 0,05.</p>
<div class="figure">
<p><img src="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/index.en_files/figure-html/indikator-1.png" alt="Interpolation Europaeische Risikogebiete für Niederschlagszunahmen und -abnahmen von mehr als 5% mit Hilfe von Kriging und Sphaerischen Viriogramm-Modellen. a: Schaetzer für Niederschlagszunahmen von mehr als 5%. b: Fehler für Niederschlagszunahmen von mehr als 5%. c: Schaetzer für Niederschlagsabnahmen von mehr als 5%. d: Fehler für Niederschlagsabnahmen von mehr als 5%." width="50%" /><img src="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/index.en_files/figure-html/indikator-2.png" alt="Interpolation Europaeische Risikogebiete für Niederschlagszunahmen und -abnahmen von mehr als 5% mit Hilfe von Kriging und Sphaerischen Viriogramm-Modellen. a: Schaetzer für Niederschlagszunahmen von mehr als 5%. b: Fehler für Niederschlagszunahmen von mehr als 5%. c: Schaetzer für Niederschlagsabnahmen von mehr als 5%. d: Fehler für Niederschlagsabnahmen von mehr als 5%." width="50%" /><img src="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/index.en_files/figure-html/indikator-3.png" alt="Interpolation Europaeische Risikogebiete für Niederschlagszunahmen und -abnahmen von mehr als 5% mit Hilfe von Kriging und Sphaerischen Viriogramm-Modellen. a: Schaetzer für Niederschlagszunahmen von mehr als 5%. b: Fehler für Niederschlagszunahmen von mehr als 5%. c: Schaetzer für Niederschlagsabnahmen von mehr als 5%. d: Fehler für Niederschlagsabnahmen von mehr als 5%." width="50%" /><img src="https://hammerflyhub.github.io/post/2021-10-08-klimawandel-in-europa/index.en_files/figure-html/indikator-4.png" alt="Interpolation Europaeische Risikogebiete für Niederschlagszunahmen und -abnahmen von mehr als 5% mit Hilfe von Kriging und Sphaerischen Viriogramm-Modellen. a: Schaetzer für Niederschlagszunahmen von mehr als 5%. b: Fehler für Niederschlagszunahmen von mehr als 5%. c: Schaetzer für Niederschlagsabnahmen von mehr als 5%. d: Fehler für Niederschlagsabnahmen von mehr als 5%." width="50%" /></p>
<p class="caption">
Figure 5: Interpolation Europaeische Risikogebiete für Niederschlagszunahmen und -abnahmen von mehr als 5% mit Hilfe von Kriging und Sphaerischen Viriogramm-Modellen. a: Schaetzer für Niederschlagszunahmen von mehr als 5%. b: Fehler für Niederschlagszunahmen von mehr als 5%. c: Schaetzer für Niederschlagsabnahmen von mehr als 5%. d: Fehler für Niederschlagsabnahmen von mehr als 5%.
</p>
</div>
<h1 id="diskussion">Diskussion</h1>
<p>Die Niederschläge insgesamt nehmen im Norden zu und im Süden ab. Dies ist wahrscheinlich hauptsächlich auf die Auswirkungen der globalen Erwärmung zurückzuführen. Die Temperatur in Norwegen stieg zwischen 1900 und 2008 um 0,9 °C (<a href="#ref-climate"><em>Climate Change in Norway</em>, 2021</a>). Die steigende Temperatur und das reichliche Wasserangebot des nahen Atlantiks führten zu einer raschen Verdunstung des Wassers und in der Folge zu einer Zunahme der Niederschläge. Die außergewöhnlich trockene Mittelmeerregion hingegen könnte mit der verstärkten Antizyklonen Zirkulation und der Nordverschiebung der atlantischen Sturmbahn zusammenhängen (<a href="#ref-giorgi2008">Giorgi &amp; Lionello, 2008</a>). Darüber hinaus ein positiver NAO-Index kann auch dazu führen, dass in Nordeuropa mehr und im Mittelmeerraum weniger Niederschlag fällt (<a href="#ref-climate2008">Bates et al., 2008</a>). Gleichzeitig entspricht die Variation der Niederschlagsmenge eindeutig der Verteilung von Biomen. Dies kann durch topografische Faktoren beeinflusst werden. Zum Beispiel blockiert die skandinavischen Berge im Norden einen Teil der feuchten atlantischen Luftströmungen, wodurch die Niederschläge in dieser Region stärker zunehmen als in den umliegenden Gebieten.</p>
<p>Veränderungen bei den Niederschlägen können sich in mehrfacher Hinsicht negativ auswirken. Höhere Temperaturen und geringere durchschnittliche Niederschläge erhöhen die Wahrscheinlichkeit von Hitzewellen und Dürreperioden, die das Wachstum der Pflanzen beeinträchtigen können (<a href="#ref-climate2008">Bates et al., 2008</a>). Die Mittelmeerregion, in der bereits im Sommer wenig Niederschlag fällt, ist hoch brandgefährdet. In Regionen mit erhöhtem Niederschlagsrisiko erhöhen extreme Regenfälle die Wahrscheinlichkeit von Überschwemmungen und können in Ländern wie Norwegen, die auf Wasserkraft angewiesen sind, schwere Schäden verursachen. Darüber hinaus können sich auch Veränderungen bei den Niederschlägen auf die Qualität und Quantität des Wassers in Europa auswirken (<a href="#ref-climate2008">Bates et al., 2008</a>). Denn sowohl extreme Regenfälle als auch Dürreperioden können die Mikroorganismen im Wasser erhöhen, die wiederum Krankheiten verursachen können. Geringe Niederschläge im Mittelmeerraum könnte auch zum Verschwinden einiger kurzlebiger aquatischer Ökosysteme führen, während die biologische Vielfalt im Mittelmeerraum, einem sensiblen Gebiet für die biologische Vielfalt, ebenfalls stark beeinträchtigt werden könnte, wenn die Niederschläge weiter abnehmen (<a href="#ref-newbold2020">Newbold et al., 2020</a>).</p>
<p>Die Niederschlagsverhältnisse in Europa haben sich in den letzten Jahrzehnten erheblich verändert. Zwischen der Zeiträumen 1962-1970 und 2010 bis 2018 hat der Jahresniederschlag in Europa in der nördlichen Tundra um 20 % zugenommen und in den südlichen Mittelmeerwäldern um 25 % abgenommen. Dies kann durch Faktoren wie die globale Erwärmung und die Topografie beeinflusst werden, die zu Katastrophen wie Dürren und Überschwemmungen führen können, mit negativen Auswirkungen auf die Landwirtschaft, die Energieversorgung, die menschliche Gesundheit und die biologische Vielfalt. Initiativen zur Bekämpfung des Klimawandels sind unerlässlich.</p>
<h1 id="literatur">Literatur</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-climate2008" class="csl-entry">
<p>Bates, B., Kundzewicz, Z. W., &amp; IPCC (Eds.). (2008). <em>Climate change and water</em>.</p>
</div>
<div id="ref-climate" class="csl-entry">
<p><em>Climate change in Norway</em>. (2021). <a href="https://www.climatechangepost.com/norway/climate-change/">https://www.climatechangepost.com/norway/climate-change/</a></p>
</div>
<div id="ref-dahlman2009" class="csl-entry">
<p>Dahlman, L. (2009). <em>Climate variability: North atlantic oscillation | NOAA climate.gov</em>. <a href="https://www.climate.gov/news-features/understanding-climate/climate-variability-north-atlantic-oscillation">https://www.climate.gov/news-features/understanding-climate/climate-variability-north-atlantic-oscillation</a></p>
</div>
<div id="ref-giorgi2008" class="csl-entry">
<p>Giorgi, F., &amp; Lionello, P. (2008). Climate change projections for the Mediterranean region. <em>Global and Planetary Change</em>, <em>63</em>(2-3), 90–104. <a href="https://doi.org/10.1016/j.gloplacha.2007.09.005">https://doi.org/10.1016/j.gloplacha.2007.09.005</a></p>
</div>
<div id="ref-newbold2020" class="csl-entry">
<p>Newbold, T., Oppenheimer, P., Etard, A., &amp; Williams, J. J. (2020). Tropical and Mediterranean biodiversity is disproportionately sensitive to land-use and climate change. <em>Nature Ecology &amp; Evolution</em>, <em>4</em>(12), 1630–1638. <a href="https://doi.org/10.1038/s41559-020-01303-0">https://doi.org/10.1038/s41559-020-01303-0</a></p>
</div>
</div>
<h1 id="anhang">Anhang</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="c1">############################################################################</span>
<span class="c1">############################################################################</span>
<span class="c1">###                                                                      ###</span>
<span class="c1">###              ABSCHLUSSPROJEKT: ANALYSE R UMLICHER DATEN              ###</span>
<span class="c1">###                        KLIMAWANDEL IN EUROPA                         ###</span>
<span class="c1">###                              RUOHAN LI                               ###</span>
<span class="c1">###                              12.09.2021                              ###</span>
<span class="c1">###                                                                      ###</span>
<span class="c1">############################################################################</span>
<span class="c1">############################################################################</span>

<span class="c1">##///////////////////////////////////////////////////////////////</span>
<span class="c1">##                          Aufgabe 1                          //</span>
<span class="c1">##///////////////////////////////////////////////////////////////</span>
<span class="n">kw</span><span class="o">&lt;-</span><span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;KlimaStatEuropa_Niedersschlaege.txt&#34;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>
<span class="n">kw</span><span class="o">$</span><span class="n">DeltaN</span> <span class="o">&lt;-</span> <span class="n">kw</span><span class="o">$</span><span class="n">Prec_2010to18_mean</span> <span class="o">-</span> <span class="n">kw</span><span class="o">$</span><span class="n">Prec_1962to70_mean</span>
<span class="n">kw</span><span class="o">$</span><span class="n">deltaN</span> <span class="o">&lt;-</span> <span class="n">kw</span><span class="o">$</span><span class="n">DeltaN</span><span class="o">/</span><span class="n">kw</span><span class="o">$</span><span class="n">Prec_1962to70_mean</span>
<span class="nf">library</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="n">kw.sp.dat</span> <span class="o">&lt;-</span> <span class="nf">SpatialPointsDataFrame</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="n">kw</span><span class="nf">[c</span><span class="p">(</span><span class="s">&#34;lon&#34;</span><span class="p">,</span><span class="s">&#34;lat&#34;</span><span class="p">)</span><span class="n">]</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">kw</span><span class="p">,</span><span class="n">proj4string</span> <span class="o">=</span> <span class="nf">CRS</span><span class="p">(</span><span class="s">&#34;+init=epsg:4326&#34;</span><span class="p">))</span> <span class="c1"># WSG 84</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tmap</span><span class="p">)</span>
<span class="nf">tmap_options</span><span class="p">(</span><span class="n">bg.color</span> <span class="o">=</span> <span class="s">&#34;lightblue&#34;</span><span class="p">)</span>
<span class="nf">tm_shape</span><span class="p">(</span><span class="n">kw.sp.dat</span><span class="p">)</span><span class="o">+</span><span class="nf">tm_symbols</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">0.4</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&#34;DeltaN&#34;</span><span class="p">,</span><span class="n">midpoint</span> <span class="o">=</span> <span class="kc">NA</span><span class="p">,</span><span class="n">legend.hist</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span><span class="o">+</span><span class="nf">tm_layout</span><span class="p">(</span><span class="n">legend.outside</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span><span class="n">legend.hist.width</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">tm_shape</span><span class="p">(</span><span class="n">kw.sp.dat</span><span class="p">)</span><span class="o">+</span><span class="nf">tm_symbols</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">0.4</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&#34;deltaN&#34;</span><span class="p">,</span><span class="n">midpoint</span> <span class="o">=</span> <span class="kc">NA</span><span class="p">,</span><span class="n">legend.hist</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span><span class="o">+</span><span class="nf">tm_layout</span><span class="p">(</span><span class="n">legend.outside</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span><span class="n">legend.hist.width</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>

<span class="c1">##///////////////////////////////////////////////////////////////</span>
<span class="c1">##                          Aufgabe 2                          //</span>
<span class="c1">##///////////////////////////////////////////////////////////////</span>
<span class="nf">library</span><span class="p">(</span><span class="n">rgdal</span><span class="p">)</span>
<span class="n">europa</span> <span class="o">&lt;-</span> <span class="nf">readOGR</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s">&#34;Biome_Europa&#34;</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="s">&#34;Biomes_Europa&#34;</span><span class="p">)</span>

<span class="nf">tm_shape</span><span class="p">(</span><span class="n">europa</span><span class="p">)</span><span class="o">+</span>  <span class="c1"># Verteilung der Biomen und Klimastationen</span>
  <span class="nf">tm_polygons</span><span class="p">(</span><span class="s">&#34;Biom_Name&#34;</span><span class="p">)</span><span class="o">+</span>
  <span class="nf">tm_shape</span><span class="p">(</span><span class="n">kw.sp.dat</span><span class="p">)</span><span class="o">+</span>
  <span class="nf">tm_symbols</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">0.1</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&#34;white&#34;</span><span class="p">)</span><span class="o">+</span>
  <span class="nf">tm_layout</span><span class="p">(</span><span class="n">legend.outside</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span><span class="n">legend.outside.size</span> <span class="o">=</span> <span class="m">0.54</span><span class="p">)</span>

<span class="n">MDeltaN</span> <span class="o">&lt;-</span> <span class="nf">aggregate</span><span class="p">(</span><span class="n">kw.sp.dat[</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;DeltaN&#34;</span><span class="p">)</span><span class="n">]</span><span class="p">,</span><span class="n">europa</span><span class="p">,</span><span class="n">FUN</span><span class="o">=</span><span class="n">mean</span><span class="p">)</span>
<span class="n">europa</span><span class="o">@</span><span class="n">data</span><span class="o">$</span><span class="n">MDeltaN</span> <span class="o">&lt;-</span> <span class="n">MDeltaN</span><span class="o">@</span><span class="n">data</span><span class="o">$</span><span class="n">DeltaN</span>
<span class="n">europa</span><span class="o">@</span><span class="n">data</span><span class="o">$</span><span class="n">id</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">9</span>

<span class="nf">tm_shape</span><span class="p">(</span><span class="n">europa</span><span class="p">)</span><span class="o">+</span><span class="nf">tm_polygons</span><span class="p">(</span><span class="s">&#34;MDeltaN&#34;</span><span class="p">,</span><span class="n">midpoint</span><span class="o">=</span><span class="kc">NA</span><span class="p">)</span><span class="o">+</span>  <span class="c1"># Absolute Veränderung Karte</span>
  <span class="nf">tm_text</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&#34;black&#34;</span><span class="p">)</span><span class="o">+</span>
  <span class="nf">tm_add_legend</span><span class="p">(</span><span class="s">&#34;text&#34;</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">europa</span><span class="o">$</span><span class="n">Biom_Name</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="n">europa</span><span class="o">$</span><span class="n">id</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="o">+</span>
  <span class="nf">tm_layout</span><span class="p">(</span><span class="n">legend.outside</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span><span class="n">legend.outside.size</span><span class="o">=</span><span class="m">0.54</span><span class="p">)</span>

<span class="n">MdeltaN</span> <span class="o">&lt;-</span> <span class="nf">aggregate</span><span class="p">(</span><span class="n">kw.sp.dat[</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;deltaN&#34;</span><span class="p">)</span><span class="n">]</span><span class="p">,</span><span class="n">europa</span><span class="p">,</span><span class="n">FUN</span><span class="o">=</span><span class="n">mean</span><span class="p">)</span>
<span class="n">europa</span><span class="o">@</span><span class="n">data</span><span class="o">$</span><span class="n">MdeltaN</span> <span class="o">&lt;-</span> <span class="n">MdeltaN</span><span class="o">@</span><span class="n">data</span><span class="o">$</span><span class="n">deltaN</span>
<span class="nf">tm_shape</span><span class="p">(</span><span class="n">europa</span><span class="p">)</span><span class="o">+</span><span class="nf">tm_polygons</span><span class="p">(</span><span class="s">&#34;MdeltaN&#34;</span><span class="p">,</span><span class="n">midpoint</span><span class="o">=</span><span class="kc">NA</span><span class="p">)</span><span class="o">+</span>  <span class="c1"># relative Veränderung Karte</span>
        <span class="nf">tm_text</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&#34;black&#34;</span><span class="p">)</span><span class="o">+</span>
        <span class="nf">tm_add_legend</span><span class="p">(</span><span class="s">&#34;text&#34;</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">europa</span><span class="o">$</span><span class="n">Biom_Name</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="n">europa</span><span class="o">$</span><span class="n">id</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="o">+</span>
        <span class="nf">tm_layout</span><span class="p">(</span><span class="n">legend.outside</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span><span class="n">legend.outside.size</span><span class="o">=</span><span class="m">0.54</span><span class="p">)</span>

<span class="c1"># absolute Veränderung barplot</span>
<span class="n">def.par</span> <span class="o">=</span> <span class="nf">par</span><span class="p">()</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">13</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&#34;tmaptools&#34;</span><span class="p">)</span>
<span class="n">color</span><span class="o">&lt;-</span> <span class="nf">ifelse</span><span class="p">(</span><span class="n">europa</span><span class="o">$</span><span class="n">MDeltaN</span><span class="o">&gt;</span><span class="m">100</span><span class="p">,</span><span class="nf">get_brewer_pal</span><span class="p">(</span><span class="s">&#34;RdYlGn&#34;</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span><span class="n">[4]</span><span class="p">,</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">europa</span><span class="o">$</span><span class="n">MDeltaN</span><span class="o">&gt;</span><span class="m">50</span><span class="p">,</span><span class="nf">get_brewer_pal</span><span class="p">(</span><span class="s">&#34;RdYlGn&#34;</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span><span class="n">[3]</span><span class="p">,</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">europa</span><span class="o">$</span><span class="n">MDeltaN</span><span class="o">&gt;</span><span class="m">0</span><span class="p">,</span><span class="nf">get_brewer_pal</span><span class="p">(</span><span class="s">&#34;RdYlGn&#34;</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span><span class="n">[2]</span><span class="p">,</span><span class="nf">get_brewer_pal</span><span class="p">(</span><span class="s">&#34;RdYlGn&#34;</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span><span class="n">[1]</span><span class="p">)))</span>

<span class="nf">barplot</span><span class="p">(</span><span class="n">europa</span><span class="o">$</span><span class="n">MDeltaN</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="nf">expression</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">Delta</span><span class="p">,</span><span class="s">&#34;N [mm]&#34;</span><span class="p">)),</span>  
        <span class="n">horiz</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span><span class="n">names.arg</span><span class="o">=</span><span class="n">europa</span><span class="o">$</span><span class="n">Biom_Name</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">las</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="n">cex.names</span> <span class="o">=</span> <span class="m">0.6</span><span class="p">,</span><span class="n">cex.axis</span><span class="o">=</span><span class="m">0.9</span><span class="p">)</span>

<span class="c1"># relative Veränderung barplot</span>
<span class="n">color</span><span class="o">&lt;-</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">europa</span><span class="o">$</span><span class="n">MdeltaN</span><span class="o">&gt;</span><span class="m">0.1</span><span class="p">,</span><span class="nf">get_brewer_pal</span><span class="p">(</span><span class="s">&#34;RdYlGn&#34;</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span><span class="n">[5]</span><span class="p">,</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">europa</span><span class="o">$</span><span class="n">MdeltaN</span><span class="o">&gt;</span><span class="m">0.05</span><span class="p">,</span><span class="nf">get_brewer_pal</span><span class="p">(</span><span class="s">&#34;RdYlGn&#34;</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span><span class="n">[4]</span><span class="p">,</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">europa</span><span class="o">$</span><span class="n">MdeltaN</span><span class="o">&gt;</span><span class="m">0</span><span class="p">,</span><span class="nf">get_brewer_pal</span><span class="p">(</span><span class="s">&#34;RdYlGn&#34;</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span><span class="n">[3]</span><span class="p">,</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">europa</span><span class="o">$</span><span class="n">MdeltaN</span><span class="o">&gt;</span><span class="m">-0.05</span><span class="p">,</span><span class="nf">get_brewer_pal</span><span class="p">(</span><span class="s">&#34;RdYlGn&#34;</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span><span class="n">[2]</span><span class="p">,</span><span class="nf">get_brewer_pal</span><span class="p">(</span><span class="s">&#34;RdYlGn&#34;</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span><span class="n">[1]</span><span class="p">))))</span>

<span class="nf">barplot</span><span class="p">(</span><span class="n">europa</span><span class="o">$</span><span class="n">MdeltaN</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="nf">expression</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span><span class="s">&#34;N&#34;</span><span class="p">)),</span>
        <span class="n">horiz</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span><span class="n">names.arg</span><span class="o">=</span><span class="n">europa</span><span class="o">$</span><span class="n">Biom_Name</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">las</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="n">cex.names</span> <span class="o">=</span> <span class="m">0.6</span><span class="p">,</span><span class="n">cex.axis</span><span class="o">=</span><span class="m">0.9</span><span class="p">)</span>

<span class="nf">par</span><span class="p">(</span><span class="n">def.par</span><span class="p">)</span>

<span class="c1">##///////////////////////////////////////////////////////////////</span>
<span class="c1">##                          Aufgabe 3                          //</span>
<span class="c1">##///////////////////////////////////////////////////////////////</span>

<span class="c1">##---------------------------------------------------------------</span>
<span class="c1">##  3.1 Trendmodell                                            --</span>
<span class="c1">##---------------------------------------------------------------</span>
<span class="n">mod</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">deltaN</span> <span class="o">~</span>  <span class="n">lat</span> <span class="o">+</span> <span class="n">lon</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat^2</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lon^2</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat</span><span class="o">*</span><span class="n">lon</span><span class="p">)</span> <span class="o">+</span> 
            <span class="nf">I</span><span class="p">(</span><span class="n">lon^3</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat^3</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat^2</span><span class="o">*</span><span class="n">lon</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat</span><span class="o">*</span><span class="n">lon^2</span><span class="p">),</span><span class="n">data</span><span class="o">=</span><span class="n">kw.sp.dat</span><span class="p">)</span>
<span class="n">trend.mod</span> <span class="o">&lt;-</span> <span class="nf">step</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>  <span class="c1"># k = 4 ~ Annahme eines Signifikanz-Niveaus von 0.05 *</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">trend.mod</span><span class="p">)</span>
<span class="c1">## </span>
<span class="c1">## Call:</span>
<span class="c1">## lm(formula = deltaN ~ lon + I(lat^2) + I(lat * lon) + I(lon^3) + </span>
<span class="c1">##     I(lat * lon^2), data = kw.sp.dat)</span>
<span class="c1">## </span>
<span class="c1">## Residuals:</span>
<span class="c1">##       Min        1Q    Median        3Q       Max </span>
<span class="c1">## -0.128144 -0.034995  0.000958  0.031846  0.131952 </span>
<span class="c1">## </span>
<span class="c1">## Coefficients:</span>
<span class="c1">##                  Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="c1">## (Intercept)    -2.017e-01  1.063e-02 -18.964  &lt; 2e-16 ***</span>
<span class="c1">## lon             1.122e-02  1.352e-03   8.293 4.75e-16 ***</span>
<span class="c1">## I(lat^2)        8.123e-05  4.545e-06  17.871  &lt; 2e-16 ***</span>
<span class="c1">## I(lat * lon)   -2.763e-04  3.566e-05  -7.747 2.89e-14 ***</span>
<span class="c1">## I(lon^3)       -4.292e-06  7.853e-07  -5.465 6.19e-08 ***</span>
<span class="c1">## I(lat * lon^2)  4.761e-06  8.050e-07   5.914 4.97e-09 ***</span>
<span class="c1">## ---</span>
<span class="c1">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="c1">## </span>
<span class="c1">## Residual standard error: 0.04949 on 791 degrees of freedom</span>
<span class="c1">## Multiple R-squared:  0.5111, Adjusted R-squared:  0.508 </span>
<span class="c1">## F-statistic: 165.4 on 5 and 791 DF,  p-value: &lt; 2.2e-16</span>

<span class="c1">##----------------------------------------------------------------</span>
<span class="c1">##  3.2 Variogramm-Analyse                                      --</span>
<span class="c1">##----------------------------------------------------------------</span>
<span class="n">max.d</span> <span class="o">&lt;-</span> <span class="nf">max</span><span class="p">(</span><span class="nf">spDists</span><span class="p">(</span><span class="n">kw.sp.dat</span><span class="p">,</span><span class="n">longlat</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gstat</span><span class="p">)</span>
<span class="n">v</span> <span class="o">&lt;-</span> <span class="nf">variogram</span><span class="p">(</span><span class="nf">formula</span><span class="p">(</span><span class="n">trend.mod</span><span class="p">),</span> <span class="n">kw.sp.dat</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="m">1000</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="n">vfit.lin</span> <span class="o">&lt;-</span> <span class="nf">fit.variogram</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nf">vgm</span><span class="p">(</span><span class="m">0.003</span><span class="p">,</span><span class="s">&#34;Lin&#34;</span><span class="p">,</span><span class="m">550</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>  
<span class="nf">plot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">vfit.lin</span><span class="p">)</span>
<span class="n">vfit.lin</span>
<span class="n">vfit.sph</span> <span class="o">&lt;-</span> <span class="nf">fit.variogram</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nf">vgm</span><span class="p">(</span><span class="m">0.005</span><span class="p">,</span><span class="s">&#34;Sph&#34;</span><span class="p">,</span><span class="m">550</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
<span class="n">vfit.sph</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">vfit.sph</span><span class="p">)</span>
<span class="n">vfit.exp</span> <span class="o">&lt;-</span> <span class="nf">fit.variogram</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nf">vgm</span><span class="p">(</span><span class="m">0.003</span><span class="p">,</span><span class="s">&#34;Exp&#34;</span><span class="p">,</span><span class="m">550</span><span class="o">/</span><span class="m">4</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
<span class="n">vfit.exp</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="n">vfit.exp</span><span class="p">)</span>
<span class="n">vfit.gau</span> <span class="o">&lt;-</span> <span class="nf">fit.variogram</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nf">vgm</span><span class="p">(</span><span class="m">0.003</span><span class="p">,</span><span class="s">&#34;Gau&#34;</span><span class="p">,</span><span class="m">550</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="m">3</span><span class="p">),</span><span class="m">0</span><span class="p">))</span>
<span class="n">vfit.gau</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="n">vfit.gau</span><span class="p">)</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">v</span><span class="o">$</span><span class="n">dist</span><span class="p">,</span> <span class="n">v</span><span class="o">$</span><span class="n">gamma</span><span class="p">,</span>
     <span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;darkred&#34;</span><span class="p">,</span>
     <span class="n">cex.lab</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span> <span class="n">cex.axis</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span>
     <span class="n">xlab</span><span class="o">=</span><span class="s">&#34;Distanz&#34;</span><span class="p">,</span> <span class="n">ylab</span><span class="o">=</span><span class="s">&#34;Semivarianz&#34;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">variogramLine</span><span class="p">(</span><span class="n">vfit.lin</span><span class="p">,</span> <span class="n">maxdist</span> <span class="o">=</span> <span class="m">1000</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;orange&#34;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">variogramLine</span><span class="p">(</span><span class="n">vfit.sph</span><span class="p">,</span> <span class="n">maxdist</span> <span class="o">=</span> <span class="m">1000</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;deepskyblue&#34;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">variogramLine</span><span class="p">(</span><span class="n">vfit.exp</span><span class="p">,</span> <span class="n">maxdist</span> <span class="o">=</span> <span class="m">1000</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;green3&#34;</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">variogramLine</span><span class="p">(</span><span class="n">vfit.gau</span><span class="p">,</span> <span class="n">maxdist</span> <span class="o">=</span> <span class="m">1000</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;indianred&#34;</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="m">4</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>

<span class="nf">legend</span><span class="p">(</span><span class="s">&#34;bottomright&#34;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;Linear&#34;</span><span class="p">,</span><span class="s">&#34;Sphärisch&#34;</span><span class="p">,</span><span class="s">&#34;Exponentiell&#34;</span><span class="p">,</span><span class="s">&#34;Gauss&#34;</span><span class="p">),</span>
       <span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">),</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span>
       <span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;orange&#34;</span><span class="p">,</span><span class="s">&#34;deepskyblue&#34;</span><span class="p">,</span><span class="s">&#34;green3&#34;</span><span class="p">,</span><span class="s">&#34;indianred&#34;</span><span class="p">))</span>

<span class="c1"># Parameter der Modelle</span>
<span class="n">Pars.VariogrammModelle</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span> <span class="n">Modell</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;Linear&#34;</span><span class="p">,</span><span class="s">&#34;Sphärisch&#34;</span><span class="p">,</span><span class="s">&#34;Exponential&#34;</span><span class="p">,</span><span class="s">&#34;Gauss&#34;</span><span class="p">),</span>
                                      <span class="n">Nugget</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">vfit.lin</span><span class="o">$</span><span class="n">psill[1]</span><span class="p">,</span> <span class="n">vfit.sph</span><span class="o">$</span><span class="n">psill[1]</span><span class="p">,</span> <span class="n">vfit.exp</span><span class="o">$</span><span class="n">psill[1]</span><span class="p">,</span><span class="n">vfit.gau</span><span class="o">$</span><span class="n">psill[1]</span><span class="p">),</span>
                                      <span class="n">Sill</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">vfit.lin</span><span class="o">$</span><span class="n">psill</span><span class="p">),</span><span class="nf">sum</span><span class="p">(</span><span class="n">vfit.sph</span><span class="o">$</span><span class="n">psill</span><span class="p">),</span><span class="nf">sum</span><span class="p">(</span><span class="n">vfit.exp</span><span class="o">$</span><span class="n">psill</span><span class="p">),</span> <span class="nf">sum</span><span class="p">(</span><span class="n">vfit.gau</span><span class="o">$</span><span class="n">psill</span><span class="p">)),</span>
                                      <span class="n">Practical_Range</span><span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">vfit.lin</span><span class="o">$</span><span class="n">range[2]</span><span class="p">,</span> <span class="n">vfit.sph</span><span class="o">$</span><span class="n">range[2]</span><span class="p">,</span> <span class="m">3</span><span class="o">*</span><span class="n">vfit.exp</span><span class="o">$</span><span class="n">range[2]</span><span class="p">,</span> <span class="nf">sqrt</span><span class="p">(</span><span class="m">3</span><span class="p">)</span><span class="o">*</span><span class="n">vfit.gau</span><span class="o">$</span><span class="n">range[2]</span><span class="p">))</span>      

<span class="n">Pars.VariogrammModelle</span> 
<span class="c1">##        Modell       Nugget        Sill Practical_Range</span>
<span class="c1">## 1      Linear 0.000000e+00 0.002869976        555.5620</span>
<span class="c1">## 2   Sphärisch 0.000000e+00 0.002978583        806.2835</span>
<span class="c1">## 3 Exponential 0.000000e+00 0.004679675       2260.2030</span>
<span class="c1">## 4       Gauss 5.909261e-05 0.002822126        536.4252</span>
<span class="nf">attr</span><span class="p">(</span><span class="n">vfit.lin</span><span class="p">,</span><span class="s">&#34;SSErr&#34;</span><span class="p">)</span>  <span class="c1"># 9.565483e-09</span>
<span class="nf">attr</span><span class="p">(</span><span class="n">vfit.sph</span><span class="p">,</span><span class="s">&#34;SSErr&#34;</span><span class="p">)</span>  <span class="c1"># 1.37018e-08</span>
<span class="nf">attr</span><span class="p">(</span><span class="n">vfit.exp</span><span class="p">,</span><span class="s">&#34;SSErr&#34;</span><span class="p">)</span>  <span class="c1"># 2.741517e-08</span>
<span class="nf">attr</span><span class="p">(</span><span class="n">vfit.gau</span><span class="p">,</span><span class="s">&#34;SSErr&#34;</span><span class="p">)</span>  <span class="c1"># 3.358725e-09, Modell mit dem geringesten Fehler!</span>

<span class="c1"># bestes Modell, kleinster Fehler</span>
<span class="n">vfit</span> <span class="o">&lt;-</span> <span class="n">vfit.gau</span>

<span class="c1">##----------------------------------------------------------------</span>
<span class="c1">##  3.3 Interpolation                                           --</span>
<span class="c1">##----------------------------------------------------------------</span>
<span class="nf">library</span><span class="p">(</span><span class="n">raster</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">&lt;-</span> <span class="nf">extent</span><span class="p">(</span><span class="n">europa</span><span class="p">)</span>
<span class="n">gitter</span> <span class="o">&lt;-</span> <span class="nf">expand.grid</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="nf">seq</span><span class="p">(</span><span class="n">coords[1]</span><span class="p">,</span><span class="n">coords[2]</span><span class="p">,</span> <span class="m">0.1666667</span><span class="p">),</span> <span class="n">lat</span><span class="o">=</span><span class="nf">seq</span><span class="p">(</span><span class="n">coords[3]</span><span class="p">,</span> <span class="n">coords[4]</span><span class="p">,</span> <span class="m">0.1666667</span><span class="p">))</span> 
<span class="nf">gridded</span><span class="p">(</span><span class="n">gitter</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="o">~</span><span class="n">lon</span><span class="o">+</span><span class="n">lat</span>
<span class="nf">proj4string</span><span class="p">(</span><span class="n">gitter</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">CRS</span><span class="p">(</span><span class="s">&#34;+init=epsg:4326&#34;</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">gitter</span><span class="p">)</span>
<span class="nf">points</span><span class="p">(</span><span class="n">kw.sp.dat</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span><span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">)</span>

<span class="c1"># Universal Kriging Ertrag</span>
<span class="n">kr.Regen</span> <span class="o">&lt;-</span> <span class="nf">krige</span><span class="p">(</span><span class="nf">formula</span><span class="p">(</span><span class="n">trend.mod</span><span class="p">),</span><span class="n">kw.sp.dat</span><span class="p">,</span> <span class="n">gitter</span><span class="p">,</span> <span class="n">vfit</span><span class="p">)</span>
<span class="n">kr.Regen</span> <span class="o">&lt;-</span> <span class="n">kr.Regen[europa</span><span class="p">,</span><span class="n">]</span>
<span class="c1"># Darstellung Schätzer und Fehlerkarte</span>
<span class="nf">spplot</span><span class="p">(</span><span class="n">kr.Regen</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="s">&#34;var1.pred&#34;</span><span class="p">,</span>  
       <span class="n">col.regions</span> <span class="o">=</span> <span class="nf">get_brewer_pal</span><span class="p">(</span><span class="s">&#34;RdYlGn&#34;</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="bp">F</span><span class="p">),</span> <span class="n">contour</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
<span class="c1"># Fehler</span>
<span class="nf">spplot</span><span class="p">(</span><span class="n">kr.Regen</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="s">&#34;var1.var&#34;</span><span class="p">,</span>      
       <span class="n">col.regions</span> <span class="o">=</span> <span class="nf">rev</span><span class="p">(</span><span class="nf">hcl.colors</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="s">&#34;reds&#34;</span><span class="p">)))</span>

<span class="c1">##///////////////////////////////////////////////////////////////</span>
<span class="c1">##                          Aufgabe 4                          //</span>
<span class="c1">##///////////////////////////////////////////////////////////////</span>

<span class="c1">##---------------------------------------------------------------</span>
<span class="c1">##  4.1 Variogramm-Analyse für Niederschlagszunahme &gt;= 5%      --</span>
<span class="c1">##---------------------------------------------------------------</span>
<span class="n">v005</span><span class="o">&lt;-</span><span class="nf">variogram</span><span class="p">(</span><span class="nf">I</span><span class="p">(</span><span class="n">deltaN</span><span class="o">&gt;=</span><span class="m">0.05</span><span class="p">)</span><span class="o">~</span><span class="n">lon</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat^2</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat</span> <span class="o">*</span> <span class="n">lon</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lon^3</span><span class="p">)</span> <span class="o">+</span> 
                  <span class="nf">I</span><span class="p">(</span><span class="n">lat</span> <span class="o">*</span> <span class="n">lon^2</span><span class="p">),</span><span class="n">kw.sp.dat</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="m">1000</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">v005</span><span class="p">)</span>
<span class="n">v005fit.lin</span> <span class="o">&lt;-</span> <span class="nf">fit.variogram</span><span class="p">(</span><span class="n">v005</span><span class="p">,</span> <span class="nf">vgm</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="s">&#34;Lin&#34;</span><span class="p">,</span><span class="m">550</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>  
<span class="nf">plot</span><span class="p">(</span><span class="n">v005</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">v005fit.lin</span><span class="p">)</span>
<span class="n">v005fit.lin</span>
<span class="n">v005fit.sph</span> <span class="o">&lt;-</span> <span class="nf">fit.variogram</span><span class="p">(</span><span class="n">v005</span><span class="p">,</span> <span class="nf">vgm</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="s">&#34;Sph&#34;</span><span class="p">,</span><span class="m">550</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
<span class="n">v005fit.sph</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">v005</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">v005fit.sph</span><span class="p">)</span>
<span class="n">v005fit.exp</span> <span class="o">&lt;-</span> <span class="nf">fit.variogram</span><span class="p">(</span><span class="n">v005</span><span class="p">,</span> <span class="nf">vgm</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="s">&#34;Exp&#34;</span><span class="p">,</span><span class="m">550</span><span class="o">/</span><span class="m">4</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
<span class="n">v005fit.exp</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">v005</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="n">v005fit.exp</span><span class="p">)</span>
<span class="n">v005fit.gau</span> <span class="o">&lt;-</span> <span class="nf">fit.variogram</span><span class="p">(</span><span class="n">v005</span><span class="p">,</span> <span class="nf">vgm</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="s">&#34;Gau&#34;</span><span class="p">,</span><span class="m">550</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="m">3</span><span class="p">),</span><span class="m">0</span><span class="p">))</span>
<span class="n">v005fit.gau</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">v005</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="n">v005fit.gau</span><span class="p">)</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">v005</span><span class="o">$</span><span class="n">dist</span><span class="p">,</span> <span class="n">v005</span><span class="o">$</span><span class="n">gamma</span><span class="p">,</span>
     <span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;darkred&#34;</span><span class="p">,</span>
     <span class="n">cex.lab</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span> <span class="n">cex.axis</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span>
     <span class="n">xlab</span><span class="o">=</span><span class="s">&#34;Distanz&#34;</span><span class="p">,</span> <span class="n">ylab</span><span class="o">=</span><span class="s">&#34;Semivarianz&#34;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">variogramLine</span><span class="p">(</span><span class="n">v005fit.lin</span><span class="p">,</span> <span class="n">maxdist</span> <span class="o">=</span> <span class="m">1000</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;orange&#34;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">variogramLine</span><span class="p">(</span><span class="n">v005fit.sph</span><span class="p">,</span> <span class="n">maxdist</span> <span class="o">=</span> <span class="m">1000</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;deepskyblue&#34;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">variogramLine</span><span class="p">(</span><span class="n">v005fit.exp</span><span class="p">,</span> <span class="n">maxdist</span> <span class="o">=</span> <span class="m">1000</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;green3&#34;</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">variogramLine</span><span class="p">(</span><span class="n">v005fit.gau</span><span class="p">,</span> <span class="n">maxdist</span> <span class="o">=</span> <span class="m">1000</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;indianred&#34;</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="m">4</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">legend</span><span class="p">(</span><span class="s">&#34;bottomright&#34;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;Linear&#34;</span><span class="p">,</span><span class="s">&#34;Sphärisch&#34;</span><span class="p">,</span><span class="s">&#34;Exponentiell&#34;</span><span class="p">,</span><span class="s">&#34;Gauss&#34;</span><span class="p">),</span>
       <span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">),</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span>
       <span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;orange&#34;</span><span class="p">,</span><span class="s">&#34;deepskyblue&#34;</span><span class="p">,</span><span class="s">&#34;green3&#34;</span><span class="p">,</span><span class="s">&#34;indianred&#34;</span><span class="p">))</span>

<span class="c1"># Parameter der Modelle</span>
<span class="n">Pars.VariogrammModelle</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span> <span class="n">Modell</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;Linear&#34;</span><span class="p">,</span><span class="s">&#34;Sphärisch&#34;</span><span class="p">,</span><span class="s">&#34;Exponential&#34;</span><span class="p">,</span><span class="s">&#34;Gauss&#34;</span><span class="p">),</span>
                                      <span class="n">Nugget</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">v005fit.lin</span><span class="o">$</span><span class="n">psill[1]</span><span class="p">,</span> <span class="n">v005fit.sph</span><span class="o">$</span><span class="n">psill[1]</span><span class="p">,</span> <span class="n">v005fit.exp</span><span class="o">$</span><span class="n">psill[1]</span><span class="p">,</span><span class="n">v005fit.gau</span><span class="o">$</span><span class="n">psill[1]</span><span class="p">),</span>
                                      <span class="n">Sill</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">v005fit.lin</span><span class="o">$</span><span class="n">psill</span><span class="p">),</span><span class="nf">sum</span><span class="p">(</span><span class="n">v005fit.sph</span><span class="o">$</span><span class="n">psill</span><span class="p">),</span><span class="nf">sum</span><span class="p">(</span><span class="n">v005fit.exp</span><span class="o">$</span><span class="n">psill</span><span class="p">),</span> <span class="nf">sum</span><span class="p">(</span><span class="n">v005fit.gau</span><span class="o">$</span><span class="n">psill</span><span class="p">)),</span>
                                      <span class="n">Practical_Range</span><span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">v005fit.lin</span><span class="o">$</span><span class="n">range[2]</span><span class="p">,</span> <span class="n">v005fit.sph</span><span class="o">$</span><span class="n">range[2]</span><span class="p">,</span> <span class="m">3</span><span class="o">*</span><span class="n">v005fit.exp</span><span class="o">$</span><span class="n">range[2]</span><span class="p">,</span> <span class="nf">sqrt</span><span class="p">(</span><span class="m">3</span><span class="p">)</span><span class="o">*</span><span class="n">v005fit.gau</span><span class="o">$</span><span class="n">range[2]</span><span class="p">))</span>      

<span class="n">Pars.VariogrammModelle</span> 
<span class="c1">##        Modell      Nugget      Sill Practical_Range</span>
<span class="c1">## 1      Linear 0.009503418 0.1365362        417.9350</span>
<span class="c1">## 2   Sphärisch 0.007344076 0.1384693        571.2088</span>
<span class="c1">## 3 Exponential 0.001588780 0.1552483        895.0053</span>
<span class="c1">## 4       Gauss 0.017409387 0.1337921        415.1046</span>
<span class="nf">attr</span><span class="p">(</span><span class="n">v005fit.lin</span><span class="p">,</span><span class="s">&#34;SSErr&#34;</span><span class="p">)</span>  <span class="c1"># 1.941087e-05 </span>
<span class="nf">attr</span><span class="p">(</span><span class="n">v005fit.sph</span><span class="p">,</span><span class="s">&#34;SSErr&#34;</span><span class="p">)</span>  <span class="c1"># 1.082632e-05, Modell mit dem geringesten Fehler!</span>
<span class="nf">attr</span><span class="p">(</span><span class="n">v005fit.exp</span><span class="p">,</span><span class="s">&#34;SSErr&#34;</span><span class="p">)</span>  <span class="c1"># 2.35502e-05</span>
<span class="nf">attr</span><span class="p">(</span><span class="n">v005fit.gau</span><span class="p">,</span><span class="s">&#34;SSErr&#34;</span><span class="p">)</span>  <span class="c1"># 1.873866e-05</span>
<span class="n">v005fit</span> <span class="o">&lt;-</span> <span class="n">v005fit.sph</span>

<span class="c1">##---------------------------------------------------------------</span>
<span class="c1">##  4.2 Interpolation für Niederschlagszunahme &gt;= 5%           --</span>
<span class="c1">##--------------------------------------------------------------- </span>
<span class="n">kr.005</span><span class="o">&lt;-</span><span class="nf">krige</span><span class="p">(</span><span class="nf">I</span><span class="p">(</span><span class="n">deltaN</span><span class="o">&gt;=</span><span class="m">0.05</span><span class="p">)</span><span class="o">~</span><span class="n">lon</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat^2</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat</span> <span class="o">*</span> <span class="n">lon</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lon^3</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat</span> <span class="o">*</span> <span class="n">lon^2</span><span class="p">),</span><span class="n">kw.sp.dat</span><span class="p">,</span><span class="n">gitter</span><span class="p">,</span><span class="n">v005fit</span><span class="p">)</span>
<span class="n">kr.005</span><span class="o">&lt;-</span> <span class="n">kr.005[europa</span><span class="p">,</span><span class="n">]</span>
<span class="n">kr.005</span><span class="o">$</span><span class="n">var1.pred</span> <span class="o">&lt;-</span> <span class="nf">pmax</span><span class="p">(</span><span class="nf">pmin</span><span class="p">(</span><span class="n">kr.005</span><span class="o">$</span><span class="n">var1.pred</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="m">0</span><span class="p">)</span>
<span class="nf">spplot</span><span class="p">(</span><span class="n">kr.005</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="s">&#34;var1.pred&#34;</span><span class="p">,</span>  <span class="n">col.regions</span> <span class="o">=</span> <span class="nf">get_brewer_pal</span><span class="p">(</span><span class="s">&#34;YlOrRd&#34;</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="bp">F</span><span class="p">),</span> 
       <span class="n">contour</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span><span class="n">par.settings</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">panel.background</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s">&#34;lightblue&#34;</span><span class="p">)))</span> 
<span class="nf">spplot</span><span class="p">(</span><span class="n">kr.005</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="s">&#34;var1.var&#34;</span><span class="p">,</span>  
       <span class="n">col.regions</span> <span class="o">=</span> <span class="nf">rev</span><span class="p">(</span><span class="nf">heat.colors</span><span class="p">(</span><span class="m">100</span><span class="p">)),</span>
       <span class="n">main</span><span class="o">=</span><span class="s">&#34;MLE&#34;</span><span class="p">,</span><span class="n">par.settings</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">panel.background</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s">&#34;lightblue&#34;</span><span class="p">)))</span> 

<span class="c1">##---------------------------------------------------------------</span>
<span class="c1">##  4.3 Variogramm-Analyse für Niederschlagsabnahme &gt;= 5%      --</span>
<span class="c1">##---------------------------------------------------------------</span>
<span class="n">vab005</span><span class="o">&lt;-</span><span class="nf">variogram</span><span class="p">(</span><span class="nf">I</span><span class="p">(</span><span class="n">deltaN</span><span class="o">&lt;=</span><span class="m">-0.05</span><span class="p">)</span><span class="o">~</span><span class="n">lon</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat^2</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat</span> <span class="o">*</span> <span class="n">lon</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lon^3</span><span class="p">)</span> <span class="o">+</span> 
                  <span class="nf">I</span><span class="p">(</span><span class="n">lat</span> <span class="o">*</span> <span class="n">lon^2</span><span class="p">),</span><span class="n">kw.sp.dat</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="m">1000</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">vab005</span><span class="p">)</span>
<span class="n">vab005fit.lin</span> <span class="o">&lt;-</span> <span class="nf">fit.variogram</span><span class="p">(</span><span class="n">vab005</span><span class="p">,</span> <span class="nf">vgm</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="s">&#34;Lin&#34;</span><span class="p">,</span><span class="m">550</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>  
<span class="nf">plot</span><span class="p">(</span><span class="n">vab005</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">vab005fit.lin</span><span class="p">)</span>
<span class="n">vab005fit.lin</span>
<span class="n">vab005fit.sph</span> <span class="o">&lt;-</span> <span class="nf">fit.variogram</span><span class="p">(</span><span class="n">vab005</span><span class="p">,</span> <span class="nf">vgm</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="s">&#34;Sph&#34;</span><span class="p">,</span><span class="m">550</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
<span class="n">vab005fit.sph</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">vab005</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">vab005fit.sph</span><span class="p">)</span>
<span class="n">vab005fit.exp</span> <span class="o">&lt;-</span> <span class="nf">fit.variogram</span><span class="p">(</span><span class="n">vab005</span><span class="p">,</span> <span class="nf">vgm</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="s">&#34;Exp&#34;</span><span class="p">,</span><span class="m">550</span><span class="o">/</span><span class="m">4</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
<span class="n">vab005fit.exp</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">vab005</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="n">vab005fit.exp</span><span class="p">)</span>
<span class="n">vab005fit.gau</span> <span class="o">&lt;-</span> <span class="nf">fit.variogram</span><span class="p">(</span><span class="n">vab005</span><span class="p">,</span> <span class="nf">vgm</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="s">&#34;Gau&#34;</span><span class="p">,</span><span class="m">550</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="m">3</span><span class="p">),</span><span class="m">0</span><span class="p">))</span>
<span class="n">vab005fit.gau</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">vab005</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="n">vab005fit.gau</span><span class="p">)</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">vab005</span><span class="o">$</span><span class="n">dist</span><span class="p">,</span> <span class="n">vab005</span><span class="o">$</span><span class="n">gamma</span><span class="p">,</span>
     <span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;darkred&#34;</span><span class="p">,</span>
     <span class="n">cex.lab</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span> <span class="n">cex.axis</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span>
     <span class="n">xlab</span><span class="o">=</span><span class="s">&#34;Distanz&#34;</span><span class="p">,</span> <span class="n">ylab</span><span class="o">=</span><span class="s">&#34;Semivarianz&#34;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">variogramLine</span><span class="p">(</span><span class="n">vab005fit.lin</span><span class="p">,</span> <span class="n">maxdist</span> <span class="o">=</span> <span class="m">1000</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;orange&#34;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">variogramLine</span><span class="p">(</span><span class="n">vab005fit.sph</span><span class="p">,</span> <span class="n">maxdist</span> <span class="o">=</span> <span class="m">1000</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;deepskyblue&#34;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">variogramLine</span><span class="p">(</span><span class="n">vab005fit.exp</span><span class="p">,</span> <span class="n">maxdist</span> <span class="o">=</span> <span class="m">1000</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;green3&#34;</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">variogramLine</span><span class="p">(</span><span class="n">vab005fit.gau</span><span class="p">,</span> <span class="n">maxdist</span> <span class="o">=</span> <span class="m">1000</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;indianred&#34;</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="m">4</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">legend</span><span class="p">(</span><span class="s">&#34;bottomright&#34;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;Linear&#34;</span><span class="p">,</span><span class="s">&#34;Sphärisch&#34;</span><span class="p">,</span><span class="s">&#34;Exponentiell&#34;</span><span class="p">,</span><span class="s">&#34;Gauss&#34;</span><span class="p">),</span>
       <span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">),</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span>
       <span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;orange&#34;</span><span class="p">,</span><span class="s">&#34;deepskyblue&#34;</span><span class="p">,</span><span class="s">&#34;green3&#34;</span><span class="p">,</span><span class="s">&#34;indianred&#34;</span><span class="p">))</span>

<span class="c1"># Parameter der Modelle</span>
<span class="n">Pars.VariogrammModelle</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span> <span class="n">Modell</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;Linear&#34;</span><span class="p">,</span><span class="s">&#34;Sphärisch&#34;</span><span class="p">,</span><span class="s">&#34;Exponential&#34;</span><span class="p">,</span><span class="s">&#34;Gauss&#34;</span><span class="p">),</span>
                                      <span class="n">Nugget</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">vab005fit.lin</span><span class="o">$</span><span class="n">psill[1]</span><span class="p">,</span> <span class="n">vab005fit.sph</span><span class="o">$</span><span class="n">psill[1]</span><span class="p">,</span> <span class="n">vab005fit.exp</span><span class="o">$</span><span class="n">psill[1]</span><span class="p">,</span><span class="n">vab005fit.gau</span><span class="o">$</span><span class="n">psill[1]</span><span class="p">),</span>
                                      <span class="n">Sill</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">vab005fit.lin</span><span class="o">$</span><span class="n">psill</span><span class="p">),</span><span class="nf">sum</span><span class="p">(</span><span class="n">vab005fit.sph</span><span class="o">$</span><span class="n">psill</span><span class="p">),</span><span class="nf">sum</span><span class="p">(</span><span class="n">vab005fit.exp</span><span class="o">$</span><span class="n">psill</span><span class="p">),</span> <span class="nf">sum</span><span class="p">(</span><span class="n">vab005fit.gau</span><span class="o">$</span><span class="n">psill</span><span class="p">)),</span>
                                      <span class="n">Practical_Range</span><span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">vab005fit.lin</span><span class="o">$</span><span class="n">range[2]</span><span class="p">,</span> <span class="n">vab005fit.sph</span><span class="o">$</span><span class="n">range[2]</span><span class="p">,</span> <span class="m">3</span><span class="o">*</span><span class="n">vab005fit.exp</span><span class="o">$</span><span class="n">range[2]</span><span class="p">,</span> <span class="nf">sqrt</span><span class="p">(</span><span class="m">3</span><span class="p">)</span><span class="o">*</span><span class="n">vab005fit.gau</span><span class="o">$</span><span class="n">range[2]</span><span class="p">))</span>      
<span class="n">Pars.VariogrammModelle</span> 
<span class="c1">##        Modell      Nugget      Sill Practical_Range</span>
<span class="c1">## 1      Linear 0.017709386 0.1480479        401.7661</span>
<span class="c1">## 2   Sphärisch 0.015477990 0.1499803        549.5554</span>
<span class="c1">## 3 Exponential 0.008748894 0.1645102        824.2274</span>
<span class="c1">## 4       Gauss 0.025783252 0.1447334        394.8932</span>
<span class="nf">attr</span><span class="p">(</span><span class="n">vab005fit.lin</span><span class="p">,</span><span class="s">&#34;SSErr&#34;</span><span class="p">)</span>  <span class="c1"># 1.738995e-05</span>
<span class="nf">attr</span><span class="p">(</span><span class="n">vab005fit.sph</span><span class="p">,</span><span class="s">&#34;SSErr&#34;</span><span class="p">)</span>  <span class="c1"># 7.158109e-06, Modell mit dem geringesten Fehler!</span>
<span class="nf">attr</span><span class="p">(</span><span class="n">vab005fit.exp</span><span class="p">,</span><span class="s">&#34;SSErr&#34;</span><span class="p">)</span>  <span class="c1"># 1.814281e-05</span>
<span class="nf">attr</span><span class="p">(</span><span class="n">vab005fit.gau</span><span class="p">,</span><span class="s">&#34;SSErr&#34;</span><span class="p">)</span>  <span class="c1"># 1.61052e-05</span>
<span class="n">vab005fit</span> <span class="o">&lt;-</span> <span class="n">vab005fit.sph</span>

<span class="c1">##---------------------------------------------------------------</span>
<span class="c1">##  4.4 Interpolation für Niederschlagsabnahme &gt;= 5%           --</span>
<span class="c1">##---------------------------------------------------------------</span>
<span class="n">kr.ab005</span><span class="o">&lt;-</span><span class="nf">krige</span><span class="p">(</span><span class="nf">I</span><span class="p">(</span><span class="n">deltaN</span><span class="o">&lt;=</span><span class="m">-0.05</span><span class="p">)</span><span class="o">~</span><span class="n">lon</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat^2</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lat</span> <span class="o">*</span> <span class="n">lon</span><span class="p">)</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">lon^3</span><span class="p">)</span> <span class="o">+</span> 
                <span class="nf">I</span><span class="p">(</span><span class="n">lat</span> <span class="o">*</span> <span class="n">lon^2</span><span class="p">),</span><span class="n">kw.sp.dat</span><span class="p">,</span><span class="n">gitter</span><span class="p">,</span><span class="n">vab005fit</span><span class="p">)</span>
<span class="n">kr.ab005</span><span class="o">&lt;-</span> <span class="n">kr.ab005[europa</span><span class="p">,</span><span class="n">]</span>
<span class="n">kr.ab005</span><span class="o">$</span><span class="n">var1.pred</span> <span class="o">&lt;-</span> <span class="nf">pmax</span><span class="p">(</span><span class="nf">pmin</span><span class="p">(</span><span class="n">kr.ab005</span><span class="o">$</span><span class="n">var1.pred</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="m">0</span><span class="p">)</span>
<span class="nf">spplot</span><span class="p">(</span><span class="n">kr.ab005</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="s">&#34;var1.pred&#34;</span><span class="p">,</span>  <span class="n">col.regions</span> <span class="o">=</span> <span class="nf">get_brewer_pal</span><span class="p">(</span><span class="s">&#34;YlOrRd&#34;</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="bp">F</span><span class="p">),</span> 
       <span class="n">contour</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span><span class="n">par.settings</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">panel.background</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s">&#34;lightblue&#34;</span><span class="p">)))</span> 
<span class="nf">spplot</span><span class="p">(</span><span class="n">kr.ab005</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="s">&#34;var1.var&#34;</span><span class="p">,</span>  
       <span class="n">col.regions</span> <span class="o">=</span> <span class="nf">rev</span><span class="p">(</span><span class="nf">heat.colors</span><span class="p">(</span><span class="m">100</span><span class="p">)),</span>
       <span class="n">main</span><span class="o">=</span><span class="s">&#34;MLE&#34;</span><span class="p">,</span><span class="n">par.settings</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">panel.background</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s">&#34;lightblue&#34;</span><span class="p">)))</span> 
</code></pre></td></tr></table>
</div>
</div>
    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E7%94%9F%E6%80%81%E5%AD%A6/">生态学</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-10-09-%E6%88%91%E5%92%8C%E9%B1%BC%E9%B3%9E%E7%97%85/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">涂身体乳缓解了我的鱼鳞病</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-10-07-notion%E6%97%A0%E6%B3%95%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87-%E5%B7%B2%E8%A7%A3%E5%86%B3/">
            <span class="next-text nav-default">notion无法上传文件（已解决）</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

      </div>
    </main>

    <footer id="footer" class="footer">
      

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021<span class="heart"><i class="iconfont icon-heart"></i></span><span>Hammerfly</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>








</body>
</html>
